<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Trilha Antirracista Digital</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f8fafc;
            margin: 0;
            padding: 0;
        }
        .intro, .boas-vindas {
            background: #1a202c;
            color: #fff;
            padding: 32px 10px 16px 10px;
            text-align: center;
            font-size: 1.3em;
        }
        .creditos {
            font-size: 1em;
            margin-top: 18px;
            color: #bee3f8;
            font-weight: bold;
            letter-spacing: 0.02em;
        }
        .escola {
            font-size: 1em;
            margin-top: 4px;
            color: #d3f9d8;
            font-weight: bold;
            letter-spacing: 0.01em;
        }
        .boas-vindas {
            background: #234e52;
            color: #fff;
            font-size: 1.08em;
            padding: 24px 10px 34px 10px;
        }
        .btn-comecar, .continuar-btn, .virar-carta-btn {
            display: block;
            margin: 22px auto 0 auto;
            background: #38b2ac;
            color: #fff;
            border: none;
            border-radius: 12px;
            padding: 15px 48px;
            font-size: 1.25em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 10px #0001;
            transition: background 0.15s;
        }
        .btn-comecar:active, .continuar-btn:active, .virar-carta-btn:active {
            background: #234e52;
        }
        .tela-jogo, .tela-jogo2, .conclusao-tela { display: none; }
        /* Adicione os estilos do jogo, popups, etc. nas próximas partes! */
        @media (max-width: 800px) {
            .intro, .boas-vindas { font-size: 1em; }
            .btn-comecar, .continuar-btn, .virar-carta-btn { font-size: 1em; padding: 12px 20px;}
        }
    </style>
</head>
<body>
    <!-- TELA 1: INTRODUÇÃO -->
    <div class="intro" id="tela1">
        <h2>Trilha Antirracista: Vozes Negras Que Inspiram</h2>
        <div class="creditos">
            Produzido por - Christopher de Andrade Cardoso <br>
            Colaboradoras - Danielli Santos & Patricia Brizola
        </div>
        <div class="escola">
            PEI - Edison Bastos Gasparini Pref.
        </div>
    </div>
    <div class="boas-vindas" id="tela1-bemvindo">
        Bem-vindos à Trilha Antirracista!<br>
        Aqui você vai conhecer mulheres e homens negros que mudaram a história do Brasil, lutaram contra o racismo e inspiram gerações com suas palavras e ações.<br><br>
        Em cada quadro, descubra um pouco da vida e da luta desses autores. Entre um quadro e outro, resolva o enigma e encontre a frase que traduz a força, a resistência e a inteligência de quem nunca aceitou o silêncio diante da injustiça.<br><br>
        <b>Seu desafio:</b> acerte qual frase pertence a cada autor ou autora.<br>
        A luta antirracista não termina aqui. Ela continua todos os dias, em cada atitude.<br>
        <b>Quem faz a trilha, faz história.</b>
        <button class="btn-comecar" id="btn-comecar">Começar trilha!</button>
    </div>

    <!-- TELA 2: JOGO FASE 1 (adicionada via JS) -->
    <div class="tela-jogo" id="tela2-jogo"></div>
    <!-- TELA 3: JOGO FASE 2 (adicionada via JS) -->
    <div class="tela-jogo2" id="tela3-jogo"></div>
    <!-- TELA 4: CONCLUSÃO -->
    <div class="conclusao-tela" id="tela4-conclusao"></div>

    <!-- SONS do jogo (mantenha os arquivos na pasta!) -->
    <audio id="success-audio" src="comencaixe.mp3"></audio>
    <audio id="erro-audio" src="semencaixe.mp3"></audio>
    <audio id="virarcarta-audio" src="cartavirando.mp3"></audio>

    <!-- MODAL DE CONTEXTO (acerto) -->
    <div id="modal-contexto" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(30,41,59,0.85); z-index:9999; align-items:center; justify-content:center;">
        <div id="modal-contento-inner" style="background:#fff; border-radius:22px; max-width:650px; min-width:340px; padding:32px 28px; box-shadow:0 8px 40px #0004; font-size:1.34em; color:#222; text-align:left; position:relative;">
            <div id="modal-contexto-texto"></div>
            <button id="fechar-modal-contexto" style="margin-top:28px; font-size:1.1em; padding:8px 24px; background:#38b2ac; color:#fff; border:none; border-radius:8px; cursor:not-allowed; opacity:0.5;">Fechar (20)</button>
        </div>
    </div>
    <!-- MODAL DE RACISMO (erro) -->
    <div id="alerta-racismo" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(39,21,21,0.75); z-index:9999; align-items:center; justify-content:center;">
        <div style="background:#fff6e1; border-radius:22px; max-width:700px; min-width:310px; padding:46px 32px 38px 32px; box-shadow:0 8px 40px #0005; font-size:1.45em; color:#a83232; text-align:left; position:relative; border:5px solid #d69e2e;">
            <b style="font-size:1.25em; color:#c53030; display:block; margin-bottom:16px;">Atenção!</b>
            <span id="texto-alerta-racismo"></span>
            <button id="fechar-alerta-racismo" style="display:block;margin:40px auto 0 auto; background:#c53030; color:#fff; border:none; font-size:1.15em; font-weight:bold; border-radius:12px; padding:12px 44px; cursor:pointer;">Racismo não!</button>
        </div>
    </div>

<!-- JS virá nas próximas partes! -->
<script>
// --- SÓ navegação inicial (o resto do JS virá na PARTE 2) ---
document.getElementById('btn-comecar').onclick = function() {
    document.getElementById('tela1').style.display = 'none';
    document.getElementById('tela1-bemvindo').style.display = 'none';
    document.getElementById('tela2-jogo').style.display = 'block';
    window.scrollTo(0,0);
};
</script>
<script>
// --------- DADOS DOS AUTORES (DIVIDIDO EM 2 FASES) ---------
const autoresFase1 = [
    {
        nome: "Carolina Maria de Jesus",
        img: "carolina.png",
        frases: [
            "O Brasil precisa ser dirigido por uma pessoa que já passou fome. A fome também é professora. Quem passa fome aprende a pensar no próximo e nas crianças.",
            "Tenho raiva dos ricos, porque eles exploram os pobres, e ninguém fala nada. O pobre está sempre calado, sempre com medo.",
            "Aqui na favela, quando alguém morre, não tem ninguém para lamentar. O pobre só serve para trabalhar e morrer."
        ],
        contextos: [
            "Moradora da favela do Canindé, em São Paulo, Carolina viveu e registrou a fome e a miséria em seu diário. Para ela, quem já sentiu a dor da fome nunca esquece do sofrimento do outro. Essa frase revela sua esperança em uma sociedade mais empática, governada por quem realmente entende a realidade do povo.",
            "Carolina nunca aceitou a injustiça social e sempre denunciou a desigualdade entre ricos e pobres. Sua escrita é um grito contra a exploração, mostrando como o silêncio dos mais pobres é resultado de um sistema opressor que cala e invisibiliza as vozes das periferias.",
            "Em seu diário, Carolina narra a solidão e o abandono vividos nas favelas. Para ela, a vida dos pobres era desvalorizada pela sociedade. Essa frase expõe o descaso e a invisibilidade impostos aos moradores das periferias urbanas, mostrando a urgência de mudança social."
        ]
    },
    {
        nome: "Conceição Evaristo",
        img: "conceicao.png",
        frases: [
            "Eles combinaram de nos matar, mas a gente combinou de não morrer.",
            "Minha mãe sempre disse: quem nasceu para semente não morre no vento.",
            "Minha escrevivência não se limita ao papel, é grito, é vida, é corpo inteiro lutando contra o silêncio imposto."
        ],
        contextos: [
            "Essa escritora cresceu em meio às dificuldades da periferia, cercada por desafios e resistências. Ela transformou o cotidiano da mulher negra em literatura e, ao invés de aceitar o silêncio imposto, se levantou como voz de muitas. Esta frase nasceu do enfrentamento diário à exclusão e mostra a força coletiva da sobrevivência.",
            "A ancestralidade é marca profunda na obra desta autora. Desde pequena, aprendeu com sua mãe e avó que o povo negro é como semente: pode até ser levado pelo vento da opressão, mas sempre cria raiz e resiste. Suas palavras sempre resgatam a força das origens e o legado transmitido de geração em geração.",
            "Para essa autora, escrever é existir. Ela criou o conceito de “escrevivência” porque sente que sua escrita nasce da vida real, das dores, conquistas e lutas. Suas obras denunciam a tentativa de calar a voz da mulher negra, mas sua literatura é ato de resistência — é vida gritando por justiça."
        ]
    },
    {
        nome: "Lima Barreto",
        img: "lima.png",
        frases: [
            "Não me querem por causa da minha cor.",
            "A cor do meu sangue, a forma dos meus cabelos, a planície do meu nariz e a dos meus lábios, tudo me denuncia. E tudo me condena.",
            "Se eu não fosse preto, seria mais considerado; seria até político."
        ],
        contextos: [
            "Filho de ex-escravizados, Lima Barreto enfrentou preconceito em todas as áreas da vida, inclusive na literatura. Mesmo sendo um dos grandes escritores do país, foi constantemente rejeitado pelos círculos elitistas. Essa frase traduz o peso do racismo institucional vivido por ele, um olhar direto sobre a exclusão sofrida no Brasil do século XX.",
            "Lima Barreto nunca escondeu suas origens, e sempre deixou claro o quanto a aparência negra era motivo de julgamento. Sua literatura traz, de forma crua, a experiência do negro que é acusado e condenado pelo simples fato de existir e ocupar espaços onde poucos esperam vê-lo.",
            "Ao escrever sobre a própria trajetória, Lima Barreto deixa claro como a cor da pele influenciou o reconhecimento (ou a falta dele) na sociedade. Ele sabia que muitos dos seus méritos seriam mais valorizados se fosse branco. Com essa frase, escancarou a barreira do preconceito e denunciou o racismo estrutural da elite brasileira."
        ]
    }
];
// --- Frases de racismo para pop-up de erro (use seu banco completo!)
const frasesRacismo = [
"Racismo estrutural – O preconceito não é só individual; está embutido nas instituições, nas leis, nos costumes e até na economia.",
"“Não existe racismo no Brasil” – Muita gente fala isso, mas é só abrir os olhos: a desigualdade racial está em todo lugar.",
"Preto parado é suspeito, correndo é ladrão – Frase triste, mas retrata o racismo cotidiano da abordagem policial.",
"Dados do IBGE (2022): Negros (pretos e pardos) representam 56% da população, mas só 28% dos cargos de chefia no Brasil.",
// ...adicione mais frases do seu banco se quiser!
];

// ------- FASE 1 --------
function criarFase1() {
    const tela2 = document.getElementById('tela2-jogo');
    tela2.innerHTML = ''; // limpa

    // Monta autores (retratos e espaços para encaixar frases)
    let html = `
        <div style="padding:10px 0 2px 0;text-align:center;">
            <h2 style="font-size:2em;color:#234e52;">Fase 1: Quem disse isso?</h2>
            <p style="font-size:1.19em;color:#222;max-width:670px;margin:0 auto 18px auto;">
                Arraste a carta para o autor correto e complete a trilha. São 9 frases para 3 autores!
            </p>
        </div>
        <div class="trilha-board" id="trilha-board-f1"></div>
        <div class="carta-central-area">
            <div class="carta-baralho" id="carta-baralho-f1" draggable="true"></div>
        </div>
        <button class="virar-carta-btn" id="virar-carta-btn-f1">
            <img src="baralho.png" alt="Baralho" style="width:28px;height:40px;vertical-align:middle;margin-right:9px;"> Virar carta!
        </button>
        <div class="parabens" id="parabens-msg-f1" style="display:none;">
            <b>Parabéns!</b> Você completou a primeira etapa da Trilha Antirracista! <br>
            <button class="continuar-btn" id="btn-continuar-fase2">Continue a trilha!</button>
        </div>
    `;
    tela2.innerHTML = html;
    montarTrilhaFase1();
    iniciarDragDropFase1();
}
criarFase1();

// --- monta a trilha com retratos e quadrados
function montarTrilhaFase1() {
    const trilhaBoard = document.getElementById("trilha-board-f1");
    trilhaBoard.innerHTML = '';
    autoresFase1.forEach((autor, aidx) => {
        let elAutor = document.createElement("div");
        elAutor.className = "autor-retrato";
        elAutor.innerHTML = `
            <img src="${autor.img}" alt="Retrato de ${autor.nome}" style="width:320px;height:180px;object-fit:contain;">
            <h3>${autor.nome}</h3>
        `;
        trilhaBoard.appendChild(elAutor);

        let espacos = document.createElement("div");
        espacos.className = "trilha-espacos";
        for (let i = 0; i < 3; i++) {
            let quad = document.createElement("div");
            quad.className = "trilha-quadrado";
            quad.dataset.autor = aidx;
            quad.dataset.idx = i;
            espacos.appendChild(quad);
        }
        trilhaBoard.appendChild(espacos);
    });
}

// --- frases embaralhadas
let frasesArrF1 = [];
autoresFase1.forEach((autor, aidx) => {
    autor.frases.forEach((frase, fidx) => {
        frasesArrF1.push({
            frase: frase,
            autorIdx: aidx,
            fraseIdx: fidx
        });
    });
});
frasesArrF1 = frasesArrF1.sort(() => Math.random() - 0.5);

let cartaAtualF1 = null;
let idxCartaF1 = 0;
let bloqueadoF1 = false;
let respostasFinalF1 = [[],[],[]];

// --- Mostra carta
function mostraBaralhoF1() {
    const cartaBaralho = document.getElementById("carta-baralho-f1");
    const btnVirar = document.getElementById("virar-carta-btn-f1");
    cartaBaralho.innerHTML = `<img src="baralho.png" alt="Baralho" style="width:80px;height:120px;opacity:0.92;">`;
    cartaBaralho.classList.add("show");
    cartaBaralho.setAttribute("draggable", true);
    btnVirar.style.display = "block";
}
mostraBaralhoF1();

// --- Virar carta (mostrar frase)
document.getElementById("virar-carta-btn-f1").onclick = function () {
    if (bloqueadoF1) return;
    if (idxCartaF1 >= frasesArrF1.length) return;
    let atual = frasesArrF1[idxCartaF1];
    document.getElementById('virarcarta-audio').currentTime = 0;
    document.getElementById('virarcarta-audio').play();
    cartaAtualF1 = atual;
    document.getElementById("carta-baralho-f1").innerHTML = `<div style="margin-bottom:6px;"><img src="baralho.png" alt="Baralho" style="width:36px;height:52px;opacity:0.55;"></div>${atual.frase}`;
    document.getElementById("carta-baralho-f1").classList.add("show");
    document.getElementById("carta-baralho-f1").setAttribute("draggable", true);
    this.style.display = "none";
};

/* -------- DRAG & DROP para desktop -------- */
document.getElementById("carta-baralho-f1").addEventListener('dragstart', function (e) {
    if (!cartaAtualF1 || bloqueadoF1) e.preventDefault();
    this.classList.add('dragging');
});
document.getElementById("carta-baralho-f1").addEventListener('dragend', function (e) {
    this.classList.remove('dragging');
});
document.querySelectorAll('.trilha-quadrado').forEach(quad => {
    quad.addEventListener('dragover', function (e) {
        if (!cartaAtualF1 || bloqueadoF1) return;
        e.preventDefault();
        this.classList.add('active');
    });
    quad.addEventListener('dragleave', function (e) {
        this.classList.remove('active');
    });
    quad.addEventListener('drop', function (e) {
        this.classList.remove('active');
        if (!cartaAtualF1 || bloqueadoF1) return;
        let autorAlvo = Number(this.dataset.autor);
        if (autorAlvo === cartaAtualF1.autorIdx && !this.classList.contains('filled')) {
            this.classList.add('filled');
            this.innerHTML = "";
            document.getElementById('success-audio').currentTime = 0;
            document.getElementById('success-audio').play();
            showModalContextoF1(cartaAtualF1.frase, autoresFase1[autorAlvo].contextos[cartaAtualF1.fraseIdx]);
            if (!respostasFinalF1[autorAlvo]) respostasFinalF1[autorAlvo] = [];
            respostasFinalF1[autorAlvo].push({ frase: cartaAtualF1.frase, contexto: autoresFase1[autorAlvo].contextos[cartaAtualF1.fraseIdx] });
            cartaAtualF1 = null;
            document.getElementById("carta-baralho-f1").classList.remove("show");
            idxCartaF1++;
            setTimeout(() => {
                if (idxCartaF1 < frasesArrF1.length) mostraBaralhoF1();
                else document.getElementById('parabens-msg-f1').style.display = 'block';
            }, 700);
        } else {
            document.getElementById('erro-audio').currentTime = 0;
            document.getElementById('erro-audio').play();
            exibirAlertaRacismoF1();
        }
    });
});

// --- MODAL DE CONTEXTO (ACERTO) FASE 1 ---
function showModalContextoF1(frase, contexto) {
    bloqueadoF1 = true;
    document.getElementById('modal-contexto-texto').innerHTML =
        `<div class="frase-modal" style="font-size:1.22em;color:#234e52;font-weight:bold;background:#fffbea; border-left:7px solid #ecc94b;margin-bottom:18px;padding:10px 15px;border-radius:18px;">"${frase}"</div>
        <div style="font-size:1.08em;">${contexto}</div>`;
    document.getElementById('modal-contexto').style.display = 'flex';
    let fecharBtn = document.getElementById('fechar-modal-contexto');
    fecharBtn.disabled = true;
    fecharBtn.classList.remove("enabled");
    fecharBtn.innerText = 'Fechar (20)';
    let tempo = 20;
    let modalTimeout = setInterval(() => {
        tempo--;
        fecharBtn.innerText = `Fechar (${tempo})`;
        if (tempo <= 0) {
            clearInterval(modalTimeout);
            fecharBtn.disabled = false;
            fecharBtn.classList.add("enabled");
            fecharBtn.innerText = 'Fechar';
        }
    }, 1000);
    fecharBtn.onclick = function() {
        if (!fecharBtn.disabled) {
            document.getElementById('modal-contexto').style.display = 'none';
            bloqueadoF1 = false;
        }
    }
}

// --- MODAL RACISMO FASE 1 ---
function exibirAlertaRacismoF1() {
    if (window.__alerta_ativo) return;
    window.__alerta_ativo = true;
    let idx = Math.floor(Math.random() * frasesRacismo.length);
    document.getElementById('texto-alerta-racismo').innerHTML = frasesRacismo[idx];
    document.getElementById('alerta-racismo').style.display = 'flex';
    bloqueadoF1 = true;
    document.getElementById('fechar-alerta-racismo').onclick = function() {
        document.getElementById('alerta-racismo').style.display = 'none';
        bloqueadoF1 = false;
        window.__alerta_ativo = false;
    }
}

// ----------- TRANSIÇÃO PARA FASE 2 -----------
document.addEventListener('click', function(e) {
    if (e.target && e.target.id === 'btn-continuar-fase2') {
        document.getElementById('tela2-jogo').style.display = 'none';
        document.getElementById('tela3-jogo').style.display = 'block';
        criarFase2(); // Vai chamar a Fase 2 (vem na Parte 3!)
        window.scrollTo(0,0);
    }
});
</script>
</html>
<!-- FASE 2 E MURAL FINAL -->
<div class="tela-jogo" id="tela3-jogo" style="display:none;">
    <div style="padding:10px 0 2px 0;text-align:center;">
        <h2 style="font-size:2em;color:#234e52;">Fase 2: Continue a trilha!</h2>
        <p style="font-size:1.19em;color:#222;max-width:670px;margin:0 auto 18px auto;">
            Agora mais 3 grandes autores! Complete os 9 quadrados com suas frases.<br>
            Arraste a carta para o autor correto.
        </p>
    </div>
    <div class="trilha-board" id="trilha-board-f2"></div>
    <div class="carta-central-area">
        <div class="carta-baralho" id="carta-baralho-f2" draggable="true"></div>
    </div>
    <button class="virar-carta-btn" id="virar-carta-btn-f2">
        <img src="baralho.png" alt="Baralho" style="width:28px;height:40px;vertical-align:middle;margin-right:9px;"> Virar carta!
    </button>
    <div class="parabens" id="parabens-msg-f2" style="display:none;">
        <b>Parabéns!</b> Você completou a Trilha Antirracista! <br>
        Veja o mural com todas as frases e histórias.<br>
        <button class="continuar-btn" id="btn-finalizar-mural">Ver mural</button>
    </div>
</div>
<div class="conclusao-tela" id="tela-final-mural" style="display:none;"></div>

<!-- MODAL DE RACISMO (COMPARTILHADO ENTRE AS DUAS FASES) -->
<div id="alerta-racismo" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:9000;justify-content:center;align-items:center;background:rgba(0,0,0,0.72)">
    <div style="background:#fff;padding:36px 34px 28px 34px;max-width:540px;border-radius:28px;box-shadow:0 8px 40px #0006;">
        <div id="texto-alerta-racismo" style="color:#c53030;font-size:1.2em;margin-bottom:24px;line-height:1.3;font-weight:bold;"></div>
        <button id="fechar-alerta-racismo" style="background:#234e52;color:#fff;padding:14px 38px;border:none;border-radius:14px;font-size:1.15em;font-weight:bold;cursor:pointer;">Racismo Não!</button>
    </div>
</div>
<script>
// --------- AUTORES FASE 2 ---------
const autoresFase2 = [
    {
        nome: "Djamila Ribeiro",
        img: "djamila.png",
        frases: [
            "Não basta não ser racista, é preciso ser antirracista.",
            "Ser antirracista é combater toda e qualquer forma de discriminação racial, é questionar privilégios e lutar pela justiça social.",
            "O silêncio diante do racismo é uma forma de consentimento."
        ],
        contextos: [
            "Djamila Ribeiro é referência nacional na luta contra o racismo. Essa frase virou lema de mobilização porque ela acredita que, para mudar de verdade, não basta se omitir ou ficar em cima do muro — é preciso agir, se posicionar e combater o racismo em todas as esferas.",
            "Filósofa e ativista, Djamila ensina que o antirracismo exige ação consciente. Não é só sobre respeitar, mas sobre desconstruir privilégios, enfrentar desigualdades e lutar para que a justiça social seja realidade para todos.",
            "Para Djamila, não se posicionar é compactuar. Ao longo de sua carreira, ela provoca o debate e chama atenção para a necessidade de romper com a neutralidade — pois o silêncio acaba protegendo quem pratica a discriminação."
        ]
    },
    {
        nome: "Sueli Carneiro",
        img: "sueli.png",
        frases: [
            "O racismo é uma experiência fundadora da existência da população negra no Brasil. Ele não é acessório, é constitutivo.",
            "A luta antirracista é um dever de toda a sociedade e não apenas das vítimas do racismo.",
            "A democracia racial é um mito que mascara a violência cotidiana sofrida pela população negra."
        ],
        contextos: [
            "Referência do movimento negro, Sueli Carneiro denuncia que o racismo não é algo pontual, mas está na raiz da formação da sociedade brasileira. Sua luta é para desconstruir essa estrutura desde a base.",
            "Ativista e pensadora, Sueli reforça que combater o racismo não é obrigação apenas das pessoas negras. A sociedade como um todo precisa assumir essa responsabilidade e agir por justiça.",
            "Ao longo dos anos, muito se falou que o Brasil era uma democracia racial, mas Sueli escancara que isso é uma ilusão. O racismo persiste, muitas vezes invisível, mas machuca, exclui e mata diariamente."
        ]
    },
    {
        nome: "Luiz Gama",
        img: "luiz.png",
        frases: [
            "Que país é este, onde o preto, o pardo e o mestiço não são homens e sim mercadoria?",
            "O que mais me espanta não é o crime do escravizador, mas a indiferença dos homens livres.",
            "A liberdade não se dá, conquista-se. E todo homem tem direito de ser livre."
        ],
        contextos: [
            "Ex-escravizado, Luiz Gama se tornou advogado autodidata e libertou centenas de pessoas da escravidão. Com esta frase, ele denuncia a desumanização brutal sofrida pelos negros no Brasil escravista.",
            "Para Luiz Gama, a pior violência não era só a escravidão em si, mas o silêncio e a omissão dos que poderiam lutar contra ela. Ele provoca: de que lado você está, quem se cala diante da injustiça?",
            "A luta de Luiz Gama foi pela liberdade conquistada, não concedida por benevolência de ninguém. Ele sempre incentivou a resistência, a luta ativa e a consciência de que todo ser humano merece ser livre por direito."
        ]
    }
];

// --- FASE 2 ---
function criarFase2() {
    // Monta autores Fase 2 (retratos e espaços)
    let trilhaBoard = document.getElementById("trilha-board-f2");
    trilhaBoard.innerHTML = '';
    autoresFase2.forEach((autor, aidx) => {
        let elAutor = document.createElement("div");
        elAutor.className = "autor-retrato";
        elAutor.innerHTML = `
            <img src="${autor.img}" alt="Retrato de ${autor.nome}" style="width:320px;height:180px;object-fit:contain;">
            <h3>${autor.nome}</h3>
        `;
        trilhaBoard.appendChild(elAutor);

        let espacos = document.createElement("div");
        espacos.className = "trilha-espacos";
        for (let i = 0; i < 3; i++) {
            let quad = document.createElement("div");
            quad.className = "trilha-quadrado";
            quad.dataset.autor = aidx;
            quad.dataset.idx = i;
            espacos.appendChild(quad);
        }
        trilhaBoard.appendChild(espacos);
    });

    // Frases embaralhadas
    let frasesArr = [];
    autoresFase2.forEach((autor, aidx) => {
        autor.frases.forEach((frase, fidx) => {
            frasesArr.push({
                frase: frase,
                autorIdx: aidx,
                fraseIdx: fidx
            });
        });
    });
    frasesArr = frasesArr.sort(() => Math.random() - 0.5);

    let cartaAtual = null;
    let idxCarta = 0;
    let bloqueado = false;
    let respostasFinal = [[],[],[]];

    // Mostra carta
    function mostraBaralho() {
        let cartaBaralho = document.getElementById("carta-baralho-f2");
        let btnVirar = document.getElementById("virar-carta-btn-f2");
        cartaBaralho.innerHTML = `<img src="baralho.png" alt="Baralho" style="width:80px;height:120px;opacity:0.92;">`;
        cartaBaralho.classList.add("show");
        cartaBaralho.setAttribute("draggable", true);
        btnVirar.style.display = "block";
    }
    mostraBaralho();

    document.getElementById("virar-carta-btn-f2").onclick = function () {
        if (bloqueado) return;
        if (idxCarta >= frasesArr.length) return;
        let atual = frasesArr[idxCarta];
        document.getElementById('virarcarta-audio').currentTime = 0;
        document.getElementById('virarcarta-audio').play();
        cartaAtual = atual;
        document.getElementById("carta-baralho-f2").innerHTML = `<div style="margin-bottom:6px;"><img src="baralho.png" alt="Baralho" style="width:36px;height:52px;opacity:0.55;"></div>${atual.frase}`;
        document.getElementById("carta-baralho-f2").classList.add("show");
        document.getElementById("carta-baralho-f2").setAttribute("draggable", true);
        this.style.display = "none";
    };

    document.getElementById("carta-baralho-f2").addEventListener('dragstart', function (e) {
        if (!cartaAtual || bloqueado) e.preventDefault();
        this.classList.add('dragging');
    });
    document.getElementById("carta-baralho-f2").addEventListener('dragend', function (e) {
        this.classList.remove('dragging');
    });

    document.querySelectorAll('#trilha-board-f2 .trilha-quadrado').forEach(quad => {
        quad.addEventListener('dragover', function (e) {
            if (!cartaAtual || bloqueado) return;
            e.preventDefault();
            this.classList.add('active');
        });
        quad.addEventListener('dragleave', function (e) {
            this.classList.remove('active');
        });
        quad.addEventListener('drop', function (e) {
            this.classList.remove('active');
            if (!cartaAtual || bloqueado) return;
            let autorAlvo = Number(this.dataset.autor);
            if (autorAlvo === cartaAtual.autorIdx && !this.classList.contains('filled')) {
                this.classList.add('filled');
                this.innerHTML = "";
                document.getElementById('success-audio').currentTime = 0;
                document.getElementById('success-audio').play();
                showModalContextoF2(cartaAtual.frase, autoresFase2[autorAlvo].contextos[cartaAtual.fraseIdx]);
                if (!respostasFinal[autorAlvo]) respostasFinal[autorAlvo] = [];
                respostasFinal[autorAlvo].push({ frase: cartaAtual.frase, contexto: autoresFase2[autorAlvo].contextos[cartaAtual.fraseIdx] });
                cartaAtual = null;
                document.getElementById("carta-baralho-f2").classList.remove("show");
                idxCarta++;
                setTimeout(() => {
                    if (idxCarta < frasesArr.length) mostraBaralho();
                    else document.getElementById('parabens-msg-f2').style.display = 'block';
                }, 700);
            } else {
                document.getElementById('erro-audio').currentTime = 0;
                document.getElementById('erro-audio').play();
                exibirAlertaRacismoF2();
            }
        });
    });

    // MODAL DE CONTEXTO (ACERTO) FASE 2
    function showModalContextoF2(frase, contexto) {
        bloqueado = true;
        document.getElementById('modal-contexto-texto').innerHTML =
            `<div class="frase-modal" style="font-size:1.22em;color:#234e52;font-weight:bold;background:#fffbea; border-left:7px solid #ecc94b;margin-bottom:18px;padding:10px 15px;border-radius:18px;">"${frase}"</div>
            <div style="font-size:1.08em;">${contexto}</div>`;
        document.getElementById('modal-contexto').style.display = 'flex';
        let fecharBtn = document.getElementById('fechar-modal-contexto');
        fecharBtn.disabled = true;
        fecharBtn.classList.remove("enabled");
        fecharBtn.innerText = 'Fechar (20)';
        let tempo = 20;
        let modalTimeout = setInterval(() => {
            tempo--;
            fecharBtn.innerText = `Fechar (${tempo})`;
            if (tempo <= 0) {
                clearInterval(modalTimeout);
                fecharBtn.disabled = false;
                fecharBtn.classList.add("enabled");
                fecharBtn.innerText = 'Fechar';
            }
        }, 1000);
        fecharBtn.onclick = function() {
            if (!fecharBtn.disabled) {
                document.getElementById('modal-contexto').style.display = 'none';
                bloqueado = false;
            }
        }
    }

    // MODAL RACISMO FASE 2
    function exibirAlertaRacismoF2() {
        if (window.__alerta_ativo) return;
        window.__alerta_ativo = true;
        let idx = Math.floor(Math.random() * frasesRacismo.length);
        document.getElementById('texto-alerta-racismo').innerHTML = frasesRacismo[idx];
        document.getElementById('alerta-racismo').style.display = 'flex';
        bloqueado = true;
        document.getElementById('fechar-alerta-racismo').onclick = function() {
            document.getElementById('alerta-racismo').style.display = 'none';
            bloqueado = false;
            window.__alerta_ativo = false;
        }
    }

    // FINALIZAÇÃO/MURAL FINAL
    document.getElementById('btn-finalizar-mural').onclick = function() {
        document.getElementById('tela3-jogo').style.display = 'none';
        document.getElementById('tela-final-mural').style.display = 'block';
        mostrarConclusaoMural();
        window.scrollTo(0,0);
    };

    // Exibe mural final (TODOS autores, frases e respostas)
    function mostrarConclusaoMural() {
        let html = `<h2 style="text-align:center;margin-bottom:18px;color:#234e52;">Mural da Trilha Antirracista</h2>`;
        // Fase 1 autores
        autoresFase1.forEach((autor, aidx) => {
            html += `
            <div class="autor-conclusao">
                <img src="${autor.img}" alt="${autor.nome}">
                <div class="autor-conclusao-info">
                    <h3>${autor.nome}</h3>
                    ${(autor.frases||[]).map((frase,ix)=>`
                        <div class="frase-concluida">${frase}</div>
                        <div class="explica">${autor.contextos[ix]}</div>
                    `).join('')}
                </div>
            </div>
            `;
        });
        // Fase 2 autores
        autoresFase2.forEach((autor, aidx) => {
            html += `
            <div class="autor-conclusao">
                <img src="${autor.img}" alt="${autor.nome}">
                <div class="autor-conclusao-info">
                    <h3>${autor.nome}</h3>
                    ${(autor.frases||[]).map((frase,ix)=>`
                        <div class="frase-concluida">${frase}</div>
                        <div class="explica">${autor.contextos[ix]}</div>
                    `).join('')}
                </div>
            </div>
            `;
        });
        document.getElementById('tela-final-mural').innerHTML = html;
    }
}
</script>
